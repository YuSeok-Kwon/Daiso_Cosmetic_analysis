# Daiso 데이터 명세서

---

## ERD (테이블 관계도)

```
┌─────────────┐       ┌─────────────┐       ┌─────────────────────┐
│   brands    │       │ categories  │       │  ingredients_master │
│─────────────│       │─────────────│       │─────────────────────│
│ brand_id PK │       │category_id PK│      │ ingredient_id PK    │
│ name        │       │category_home │      │ name                │
└──────┬──────┘       │category_1    │      │ ewg_grade           │
       │              │category_2    │      │ is_caution          │
       │              └──────┬───────┘      └──────────┬──────────┘
       │                     │                         │
       ▼                     ▼                         │
┌──────────────────────────────────────┐              │
│              products                │              │
│──────────────────────────────────────│              │
│ product_code PK                      │              │
│ brand_id FK → brands                 │              │
│ category_id FK → categories          │              │
│ name, price, country, created_at     │              │
└──────────────────┬───────────────────┘              │
                   │                                   │
       ┌───────────┼───────────┬───────────┐          │
       ▼           ▼           ▼           ▼          │
┌────────────┐┌────────────┐┌────────────┐┌───────────┴───┐
│ product_   ││ product_   ││ product_   ││ product_      │
│ attributes ││ metrics    ││ ingredients││ ingredients   │
│────────────││────────────││────────────││───────────────│
│product_code││product_code││product_code││ingredient_id  │
│group       ││likes       ││ingredient_ ││  FK→ingredients│
│is_function ││shares      ││  id FK     ││  _master      │
│price_tier  ││review_count││rank        │└───────────────┘
│...         ││...         │└────────────┘
└────────────┘└────────────┘

┌─────────────┐       ┌─────────────────┐
│    users    │       │ review_analysis │
│─────────────│       │─────────────────│
│ user_id PK  │       │ order_id FK     │
│ user_masked │       │ length          │
│activity_level│      │ length_category │
│rating_tendency│     │ sentiment       │
└──────┬──────┘       │ sentiment_score │
       │              │ promo_type      │
       ▼              └────────┬────────┘
┌──────────────────────────────┴────────┐
│              reviews                  │
│───────────────────────────────────────│
│ order_id PK                           │
│ product_code FK → products            │
│ user_id FK → users                    │
│ write_date, rating, text, image_count │
│ is_reorder                            │
└───────────────────────────────────────┘

┌─────────────────┐
│   promotions    │
│─────────────────│
│ promotion_id PK │
│ brand_id FK     │
│ start_date      │
│ end_date        │
│ description     │
│ event_type      │
└─────────────────┘
```

---

## 테이블 목록

| #   | 테이블명            | 설명               | 주요 키                          |
| --- | ------------------- | ------------------ | -------------------------------- |
| 1   | brands              | 브랜드 정보        | brand_id (PK)                    |
| 2   | categories          | 상품 카테고리 정보 | category_id (PK)                 |
| 3   | products            | 상품 기본 정보     | product_code (PK)                |
| 4   | product_attributes  | 상품 속성 정보     | product_code (FK)                |
| 5   | product_ingredients | 상품-성분 매핑     | product_code, ingredient_id (FK) |
| 6   | product_metrics     | 상품 성과 지표     | product_code (FK)                |
| 7   | ingredients_master  | 성분 마스터        | ingredient_id (PK)               |
| 8   | users               | 사용자 정보        | user_id (PK)                     |
| 9   | reviews             | 리뷰 정보          | order_id (PK)                    |
| 10  | review_analysis     | 리뷰 분석 결과     | order_id (FK)                    |
| 11  | promotions          | 프로모션 정보      | promotion_id (PK)                |

---

## 테이블 상세 명세

### 1. brands

> 브랜드 마스터 테이블

| 컬럼명   | 데이터 타입 | NULL 허용 | 키  | 설명               |
| -------- | ----------- | --------- | --- | ------------------ |
| brand_id | INT64       | -         | PK  | 브랜드 고유 식별자 |
| name     | STRING      | -         | -   | 브랜드명           |

---

### 2. categories

> 상품 카테고리 계층 구조 테이블

| 컬럼명        | 데이터 타입 | NULL 허용 | 키  | 설명                  |
| ------------- | ----------- | --------- | --- | --------------------- |
| category_id   | INT64       | -         | PK  | 카테고리 고유 식별자  |
| category_home | STRING      | -         | -   | 홈 카테고리 (최상위)  |
| category_1    | STRING      | -         | -   | 1차 카테고리          |
| category_2    | STRING      | -         | -   | 2차 카테고리 (최하위) |

---

### 3. products

> 상품 기본 정보 테이블 (핵심 팩트 테이블)

| 컬럼명       | 데이터 타입 | NULL 허용 | 키  | 설명                       |
| ------------ | ----------- | --------- | --- | -------------------------- |
| product_code | INT64       | -         | PK  | 상품 고유 코드             |
| brand_id     | INT64       | -         | FK  | 브랜드 ID (→ brands)       |
| category_id  | INT64       | -         | FK  | 카테고리 ID (→ categories) |
| name         | STRING      | -         | -   | 상품명                     |
| price        | INT64       | -         | -   | 가격 (원)                  |
| country      | STRING      | -         | -   | 제조국                     |
| created_at   | TIMESTAMP   | -         | -   | 등록일시                   |

---

### 4. product_attributes

> 상품 속성 및 기능성 정보 테이블

| 컬럼명            | 데이터 타입 | NULL 허용 | 키  | 설명                   |
| ----------------- | ----------- | --------- | --- | ---------------------- |
| product_code      | INT64       | -         | FK  | 상품 코드 (→ products) |
| group             | STRING      | -         | -   | 상품 그룹              |
| is_functional     | BOOL        | -         | -   | 기능성 여부            |
| price_tier        | STRING      | -         | -   | 가격대 구분            |
| price_position    | STRING      | -         | -   | 가격 포지션            |
| item_ph           | STRING      | -         | -   | 제품 pH                |
| whitening         | BOOL        | -         | -   | 미백 기능 여부         |
| wrinkle_reduction | BOOL        | -         | -   | 주름개선 기능 여부     |
| sunscreen         | BOOL        | -         | -   | 자외선차단 기능 여부   |
| can_vegan         | STRING      | -         | -   | 비건 가능 여부         |
| can_halal         | STRING      | -         | -   | 할랄 가능 여부         |

---

### 5. product_ingredients

> 상품-성분 매핑 테이블 (N:M 관계)

| 컬럼명        | 데이터 타입 | NULL 허용 | 키  | 설명                           |
| ------------- | ----------- | --------- | --- | ------------------------------ |
| product_code  | INT64       | -         | FK  | 상품 코드 (→ products)         |
| ingredient_id | INT64       | -         | FK  | 성분 ID (→ ingredients_master) |
| rank          | INT64       | -         | -   | 성분 함유 순위 (1이 가장 많음) |

---

### 6. product_metrics

> 상품 성과 지표 테이블

| 컬럼명           | 데이터 타입 | NULL 허용 | 키  | 설명                   |
| ---------------- | ----------- | --------- | --- | ---------------------- |
| product_code     | INT64       | -         | FK  | 상품 코드 (→ products) |
| likes            | INT64       | -         | -   | 좋아요 수              |
| shares           | INT64       | -         | -   | 공유 수                |
| review_count     | INT64       | -         | -   | 리뷰 수                |
| engagement_score | FLOAT64     | -         | -   | 인게이지먼트 점수      |
| cp_index         | FLOAT64     | -         | -   | 가성비 지수            |
| is_god_sung_bi   | BOOL        | -         | -   | 갓성비 상품 여부       |
| review_density   | FLOAT64     | -         | -   | 리뷰 밀도              |
| last_updated     | DATE        | -         | -   | 최종 업데이트일        |

---

### 7. ingredients_master

> 성분 마스터 테이블

| 컬럼명        | 데이터 타입 | NULL 허용 | 키  | 설명                           |
| ------------- | ----------- | --------- | --- | ------------------------------ |
| ingredient_id | INT64       | -         | PK  | 성분 고유 식별자               |
| name          | STRING      | -         | -   | 성분명                         |
| ewg_grade     | STRING      | -         | -   | EWG 등급 (1-10, 낮을수록 안전) |
| is_caution    | STRING      | -         | -   | 주의 성분 여부                 |

---

### 8. users

> 사용자 정보 테이블

| 컬럼명          | 데이터 타입 | NULL 허용 | 키  | 설명               |
| --------------- | ----------- | --------- | --- | ------------------ |
| user_id         | INT64       | -         | PK  | 사용자 고유 식별자 |
| user_masked     | STRING      | -         | -   | 마스킹된 사용자 ID |
| activity_level  | STRING      | -         | -   | 활동 수준          |
| rating_tendency | STRING      | -         | -   | 평점 성향          |

---

### 9. reviews

> 리뷰 정보 테이블

| 컬럼명       | 데이터 타입 | NULL 허용 | 키  | 설명                   |
| ------------ | ----------- | --------- | --- | ---------------------- |
| order_id     | INT64       | -         | PK  | 주문/리뷰 고유 식별자  |
| product_code | INT64       | -         | FK  | 상품 코드 (→ products) |
| user_id      | INT64       | -         | FK  | 사용자 ID (→ users)    |
| write_date   | DATE        | -         | -   | 리뷰 작성일            |
| rating       | INT64       | -         | -   | 평점 (1-5)             |
| text         | STRING      | -         | -   | 리뷰 텍스트            |
| image_count  | INT64       | -         | -   | 첨부 이미지 수         |
| is_reorder   | BOOL        | -         | -   | 재구매 여부            |

---

### 10. review_analysis

> 리뷰 분석 결과 테이블

| 컬럼명          | 데이터 타입 | NULL 허용 | 키  | 설명                       |
| --------------- | ----------- | --------- | --- | -------------------------- |
| order_id        | INT64       | -         | FK  | 주문/리뷰 ID (→ reviews)   |
| length          | INT64       | -         | -   | 리뷰 길이 (글자 수)        |
| length_category | STRING      | -         | -   | 리뷰 길이 카테고리         |
| sentiment       | STRING      | -         | -   | 감성 분류 (긍정/부정/중립) |
| sentiment_score | STRING      | -         | -   | 감성 점수                  |
| promo_type      | STRING      | -         | -   | 프로모션 유형              |

---

### 11. promotions

> 프로모션 정보 테이블

| 컬럼명       | 데이터 타입 | NULL 허용 | 키  | 설명                 |
| ------------ | ----------- | --------- | --- | -------------------- |
| promotion_id | INT64       | -         | PK  | 프로모션 고유 식별자 |
| brand_id     | FLOAT64     | -         | FK  | 브랜드 ID (→ brands) |
| start_date   | DATE        | -         | -   | 프로모션 시작일      |
| end_date     | DATE        | -         | -   | 프로모션 종료일      |
| description  | STRING      | -         | -   | 프로모션 설명        |
| event_type   | STRING      | -         | -   | 이벤트 유형          |

---

## 테이블 관계 요약

| 관계                                     | 설명                                |
| ---------------------------------------- | ----------------------------------- |
| products → brands                        | 상품은 하나의 브랜드에 속함 (N:1)   |
| products → categories                    | 상품은 하나의 카테고리에 속함 (N:1) |
| product_attributes → products            | 상품별 속성 정보 (1:1)              |
| product_metrics → products               | 상품별 성과 지표 (1:1)              |
| product_ingredients → products           | 상품에 포함된 성분 목록 (1:N)       |
| product_ingredients → ingredients_master | 성분 상세 정보 참조 (N:1)           |
| reviews → products                       | 상품에 대한 리뷰 (1:N)              |
| reviews → users                          | 사용자가 작성한 리뷰 (1:N)          |
| review_analysis → reviews                | 리뷰 분석 결과 (1:1)                |
| promotions → brands                      | 브랜드별 프로모션 (1:N)             |

---

_이 문서는 BigQuery `daiso-analysis.daiso` 데이터셋을 기반으로 자동 생성되었습니다._
