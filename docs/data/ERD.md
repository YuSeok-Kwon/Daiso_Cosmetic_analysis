### **재설계 전략**

1. **중복 데이터 제거 :** `category`, `brand` 등 반복되는 문자열을 별도 차원 테이블로 분리하는 것이 좋을 것 같습니다.
2. **데이터 성격 분리:**

- **Master Data (불변/준불변):** 상품명, 가격, 성분 등 물리적 속성.
- **Transaction Data (가변):** 리뷰, 주문 정보.
- **Analytical Data (파생):** Engagement Score, 가성비 지수, 재구매 여부 등 매일 변동 가능한 수치.

3. **ABSA(속성 기반 감성 분석) 대응:** `reviews_features`에 뭉뚱그려진 데이터를 `review_aspects` 테이블로 정규화하여 1:N 관계를 해소합니다.(앞으로 변경된다면)

---

### **상세 스키마 정의 및 변경 이유**

#### **1. 기준 정보 테이블 분리**

기존 `PRODUCTS` 테이블에 반복되던 텍스트 데이터를 별도 테이블로 분리하여 용량을 줄이고 데이터 일관성을 확보하는 것이 좋을 것 같습니다.

`BRANDS` & `CATEGORIES`

- **변경 전:** `PRODUCTS` 테이블에 `category_home`, `category_1`, `brand` 문자열 반복 저장.
- **변경 후:** ID로 관리. 브랜드명이나 카테고리명 변경 시 마스터 테이블만 수정하면 전체 반영됨 -> 가장 큰 메리트

`INGREDIENTS_MASTER`

- **변경 전:** `INGREDIENTS` 테이블에 성분명이 단순 텍스트로 저장됨.
- **변경 후:** 성분 ID를 부여하고, 성분 속성(동물성 여부, 알코올 함유 여부 등)과 앞으로 API등을 통해 추가될 속성 등을 마스터 데이터로 관리 할 수 있음.

#### **2. 상품 데이터 테이블 분리**

물리적 속성과 분석적 속성을 분리

`PRODUCTS`

- 변하지 않는 기본 정보만 유지 (`name`, `price`, `country` 등).

`PRODUCT_FUNCTIONAL_TAGS`

- **변경 전:** `PRODUCTS_FEATURES`와 `FUNCTIONAL` 테이블에 혼재된 기능성 정보(미백, 주름, 비건 가능 여부 등)를 별도로 묶습니다.
- **이유:** `engagement_score` 같은 통계치와 `is_whitening` 같은 물리적 속성은 갱신 주기가 다름. 물리적 속성은 거의 변하지 않으므로 분리하는 것이 좋을 것 같습니다.

`PRODUCT_INGREDIENTS`

- **이유 :**

1. N:M 관계 해소

제품과 성분은 다대다 관계

- 하나의 제품에 여러 성분이 들어감 (1:N)
- 하나의 성분이 여러 제품에 사용됨 (1:N)

```
[제품A] ──┬── 정제수
├── 글리세린
└── 히알루론산
[제품B] ──┬── 정제수 ← 같은 성분이 여러 제품에!!!
├── 글리세린
└── 나이아신아마이드
```

따라서 중간에 매핑 테이블을 둬서 연결합니다.

`PRODUCTS` (제품) `PRODUCT_INGREDIENTS` (매핑) `INGREDIENTS_MASTER` (성분)

2. rank = 전성분표에서의 순서(순번)입니다.

화장품 전성분표는 함량이 높은 순서대로 나열되기 때문에 향후 "히알루론산이 상위 5개 안에 있는 제품" 이나 "주의 성분이 몇 번째에 있는지로 위험도 판단 가능" 등의 분석 가능합니다.

#### **3. 분석 데이터 테이블 분리**

현재 데이터셋은 특정 시점의 스냅샷이지만, 향후 시계열 분석을 위해 설계를 변경하는 것이 좋을 것 같습니다.

`PRODUCT_METRICS`

- `likes`, `shares`, `engagement_score`, `cp_index`, `price_tier` 등을 포함.
- **핵심:** `analysis_date` 컬럼을 PK 복합키로 추가하는 것이 좋을 것 같습니다. 이를 통해 "지난달 대비 가성비 지수 변화" 등을 추적할 수 있습니다.

`REVIEW_METRICS`

- 리뷰 텍스트 자체(`REVIEWS` 테이블)와 분석 결과(재구매 여부, 리뷰 길이 등)를 분리하는 것이 좋을 것 같습니다. 분석 로직이 바뀌어 재계산하더라도 원본 리뷰 테이블은 건드리지 않아도 됩니다.

#### **4. ABSA(속성 기반 감성 분석) 대응**

`REVIEW_ASPECT_SENTIMENTS`

- 하나의 리뷰가 "배송은 빠르나(긍정), 가격은 비싸다(부정)"와 같이 여러 속성을 가질 수 있습니다.
- 기존 플랫 테이블로는 이를 표현하기 어렵습니다. 1:N 테이블로 설계하여 `aspect`(배송, 가격, 품질)별 `sentiment`와 `confidence_score`를 저장하는 것이 좋을 것 같습니다.

---
