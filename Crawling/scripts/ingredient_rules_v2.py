#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
2차 규칙.txt의 모든 규칙을 적용하는 스크립트
"""

import pandas as pd
import re

# 데이터 로드
df = pd.read_csv('/Users/yu_seok/Documents/workspace/nbCamp/Project/Why-pi/data/csv/ingredients_통합.csv')
print(f"원본 데이터: {len(df)} 행, {df['product_id'].nunique()} 제품, {df['ingredient'].nunique()} 고유 성분")

# =====================================================
# 1) 삭제 대상 (복원 불가능한 항목)
# =====================================================
delete_targets = [
    # 2차 규칙 삭제 목록
    '국민더추출물', '금사연둥지추출물', '노티드랙추출물',
    '가지멀티히아루론산', '가지비타민', '글라이콜',
    '다이메청색본', '다이바닐피아파틴', '다이메콘크로스플',
    '라우릴PEG-9폴리디', '라우릴피이지-9폴리디',
    '리우릴PEG-12트리스(프라이아릴실록시실질해틸다이메메티콘',
    '리모니아아키디시마추출물',
    '메디아티놀레알리파리아이리폴리메이트', '미미알일프롤린',
    '미미티애씨드', '미치한추출물', '모근추출물',
    '베이놀라올', '벵자추출물', '브라이트',
    '비닐카드를제품/화이미디아에알아이노아성에테크레테이토코폴리머',
    '빔쏘는베리츄마카다미아씨오일폴리글리세릴6에스터스베헤네이트',
    '사이필요한하실록시인', '송라러스듐이실리케이트', '씨대퍼딜추출물',
    '암모놀이크릴로엠디어머릴라우레이트', '에일액실세린', '엔젤알코올',
    '엔젤오브엔젤폴리부틸렌테레프탈레이트', '에틸헥실글로세몬)_황색산화장',
    '육육나무껍질추출물',
    '자자추출물', '지놀란라우릴카토코페릴리놀리메이트',
    '트리아이클릭하이트', '트크로스폴리머', '탄올리베이트',
    '파이메디아리놀레알리알파리아이리폴리메이트', '프로메타인',
    '프로판디잇용이트', '플랜트알러스추출물', '플릭애씨드',
    '하이드로제네', '하이드로제네이티드폴리', '하이드로제네이티드폴리(C6',
    '하이드로제네이티드타치하이드롤리세0트', '하이드로제네이티드파네신',
    '하이드로제네이티드폴리에선', '하이프로제네이티드폴리아이스부틴',
    '하이라이터합성플루오르플로고파이트', '호블루라이트',
    '홀린듯정주행페닐트라이메티콘',
    # 영문 마케팅/브랜드 삭제
    'Came', 'Caracol', 'Complex', 'Derm', 'Derma', 'Dermab', 'Dermabl',
    'Dermablo', 'Dermabloc', 'Dermablock', 'Dermablocks',
    'EyeowKoorningruhaer에틸헥실글리세린', 'Holl', 'Ingredient',
    'Keyligients', 'Litrail', 'Main', 'Modeling', 'Pore',
    'Recommend', 'Since', 'Skin', 'Skincare',
]

delete_mask = df['ingredient'].isin(delete_targets)
deleted_count = delete_mask.sum()
df = df[~delete_mask].copy()
print(f"삭제 후: {len(df)} 행 (삭제: {deleted_count}개)")

# =====================================================
# 2) 수정 규칙 (오타/문구 제거 후 복원)
# =====================================================
corrections = {
    # 글라이콜라이 계열
    '글라이콜라이알라노베이트': '글라이콜디알라노에이트',
    '글라이콜아이알라노베이트': '글라이콜디알라노에이트',
    '글라이콜릭애씨드': '글라이콜릭애시드',
    '글루타티온': '글루타치온',
    '글리세릴아크릴레o트/아크릴릭애씨드코폴리머': '글리세릴아크릴레이트/아크릴릭애시드코폴리머',
    '글리세릴아크릴레이트/아크릴르애씨드코폴리머': '글리세릴아크릴레이트/아크릴릭애시드코폴리머',
    '글리세릴아크릴레이트/아크림릭애씨드코폴리머': '글리세릴아크릴레이트/아크릴릭애시드코폴리머',
    '글리세릴카드릴레이트': '글리세릴카프릴레이트',
    '글리세틸카프틸레이트': '글리세릴카프릴레이트',
    '글리세틴': '글리세린',
    '검양옻나오일': '검양옻나무열매오일',
    '네오펜틸글라이콜다이에틸헉사노에이트': '네오펜틸글라이콜다이에틸헥사노에이트',
    '네오펜틸글라이콜다이협타노어이트': '네오펜틸글라이콜다이헵타노에이트',
    '네오펜틸글라이콜드이에틸헥사노에이트': '네오펜틸글라이콜다이에틸헥사노에이트',
    '노나펩타이드-1': '노나펩타이드-1',
    '노니펩타이드-1': '노나펩타이드-1',
    '늄아크릴로일다이메틸타우레이트/브이피코폴리머': '암모늄아크릴로일다이메틸타우레이트/브이피코폴리머',

    # 드럼스틱
    '드럼스트씨오일': '드럼스틱씨오일',
    '럼스틱씨오일': '드럼스틱씨오일',
    '동물루이보스추출물': '루이보스추출물',

    # 다이-t-부틸 계열
    '다이-+-부틸하이드록시하이드로신나메이트': '다이-t-부틸하이드록시하이드로신나메이트',
    '다이+-부틸하이드록시하이드로신나': '다이-t-부틸하이드록시하이드로신나메이트',
    '데하이드로아세틱애씨드': '데하이드로아세틱애시드',
    '대하이드로아세테이애씨드': '데하이드로아세틱애시드',

    # 다이프로필렌
    '다이프로필글라이콜': '다이프로필렌글라이콜',

    # 다이소듐 계열
    '다이소들이디티에이': '다이소듐이디티에이',
    '다이소듐코코암포다이아서테이트': '다이소듐코코암포다이아세테이트',
    '다이소듐이디티에이식품의약안전처무': '다이소듐이디티에이',
    '다이소듐이디티에이품질보증기준': '다이소듐이디티에이',

    # 다이메티콘 계열
    '다이메티콘/비닐다O메티콘크로스폴리머': '다이메티콘/비닐다이메티콘크로스폴리머',
    '다이메티콘/비닐다이머티콘크로스폴리머': '다이메티콘/비닐다이메티콘크로스폴리머',
    '다이메티콘/비닐다이메티콘로스폴리머': '다이메티콘/비닐다이메티콘크로스폴리머',
    '다이메티콘/비닐다이메티콘크료스폴리머': '다이메티콘/비닐다이메티콘크로스폴리머',
    '다이메티콘/비닐디이메티콘크로스폴리머': '다이메티콘/비닐다이메티콘크로스폴리머',
    '디메치콘/폴리글리세린-3크로스폴리머': '다이메티콘/폴리글리세린-3크로스폴리머',

    # 다이부틸 계열
    '다이부틸어디메이트': '다이부틸아디페이트',
    '다이카프릴릴에테르': '다이카프릴릴에터',

    # 다이아이소스테아릴 계열
    '다이아이소스터아릴말레이트': '다이아이소스테아릴말레이트',
    '다이c아소스테아릴말레이트': '다이아이소스테아릴말레이트',
    '다이o이소스테아릴말레이트': '다이아이소스테아릴말레이트',
    '다이이소스테아릴말레이트': '다이아이소스테아릴말레이트',

    # 다이머다이리놀레일
    '다이머다이리놀레일디이머다이리놀리에이트': '다이머다이리놀레일다이머다이리놀리에이트',
    '다이머다이리놀레일□이머다이리놀리에이트': '다이머다이리놀레일다이머다이리놀리에이트',
    '다이머다일리놀레일다이아이소스테아레이트': '다이머다이리놀레일다이아이소스테아레이트',

    # 다이메틸실란올
    '다이메틸실란올하이일루로네이트': '다이메틸실란올하이알루로네이트',
    '다이메틸실란올히이알': '다이메틸실란올하이알루로네이트',

    # 디스테아디모늄
    '디스테아디모늄헥토라이트': '다이스테아다이모늄헥토라이트',

    # 라우릴PEG 계열
    '라우릴PEG-8디이메티콘': '라우릴PEG-8다이메티콘',
    '라우릴PEG-9폴리다이메틸실트시에틸다이메티콘': '라우릴PEG-9폴리다이메틸실록시에틸다이메티콘',
    '라우릴피이지-10': '라우릴PEG-10',
    '라우릴피이지-3다이메티콘': '라우릴PEG-3다이메티콘',
    '라우릴피이지-8다이메티콘': '라우릴PEG-8다이메티콘',
    '라우릴피이지-9폴리다이메틸실록시에틸다이메티콘': '라우릴PEG-9폴리다이메틸실록시에틸다이메티콘',
    '라이메틸실록시설리케이트/다이메티콘올크로스폴리머': '트라이메틸실록시실리케이트/다이메티콘올크로스폴리머',

    # 라우릴PEG-10트리스 계열 통합
    '라우릴PEG-10트리라이메틸실록시)실릴에틸다이메티콘': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴PEG-10트리스(트라이메틸실록시': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴PEG-10트리스(트리이메틸실록시': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴PEG-10트리스살릴에틸다이메티콘': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴PEG-10트리스스트라이메틸실록l)실릴에틸다이메티콘': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴PEG-10트리스실릴에틸다이메E콘': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴PEG-10트리스실릴에틸다이메티콘': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴PEG-10트리스트라이메틸실록시)실릴에틸다이메티콘': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴피이지-10트리스(트라이메틸실록시)실릴에틸다이메티콘': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴피이지-10트리스실릴에틸다이메티콘': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴다이가-10트리스(트라이메릴실록시/실릴에틸디아메티콘': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴다이가-10트리스(트라이메틸실록시/실틸에틸디아메티콘': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',
    '라우릴다이지-10프리스(트라이메틸실록시(실릴메틸다이메티콘': '라우릴PEG-10트리스(트라이메틸실록시)실릴에틸다이메티콘',

    # 라우릴폴리글리세릴
    '라우릴폴리글리세를-3폴리다이메틸실록시에틸디이메티콘': '라우릴폴리글리세릴-3폴리다이메틸실록시에틸다이메티콘',
    '라우릴폴리글리세릴-3폴리디이메틸실록시에틸다이메티콘': '라우릴폴리글리세릴-3폴리다이메틸실록시에틸다이메티콘',

    # 유기산 계열 (애씨드 → 애시드)
    '라우릭애씨드': '라우릭애시드',
    '락틱애씨드': '락틱애시드',
    '락토바이오닉애씨드': '락토바이오닉애시드',
    '리놀레닉애씨드': '리놀레닉애시드',
    '리놀레익애씨드': '리놀레익애시드',
    '레틴알': '레티날',
    '락토바실러스/레몬껍질별효추출물': '락토바실러스/레몬껍질발효추출물',
    '릅나무뿌리추출물': '느릅나무뿌리추출물',
    '리세릴-2트라이아이소스테아레이트': '폴리글리세릴-2트라이아이소스테아레이트',
    '릴-2트라이아이소스테아레이트': '폴리글리세릴-2트라이아이소스테아레이트',

    # 마 계열
    '마더카식애씨드': '마데카식애시드',
    '마데카식애씨드': '마데카식애시드',
    '마그네슘피씨에이': '마그네슘PCA',
    '망가니즈클로라이드': '망간클로라이드',
    '만델릭애씨드': '만델릭애시드',
    '말릭애씨드': '말릭애시드',
    '미리스틱애씨드': '미리스틱애시드',
    '미리스트산': '미리스틱애시드',
    '마이메티콘메타크릴레이트코폴리머': '다이메티콘메타크릴레이트코폴리머',
    '마이지-75스테아레이트': 'PEG-75스테아레이트',
    '멜로우살몬메틸트라이메티콘': '메틸트라이메티콘',
    '메칠렌비스-벤조트리아졸릴테트라메칠부틸페놀': '메틸렌비스-벤조트리아졸릴테트라메틸부틸페놀',
    '미노하이드록시벤조일헥실벤조에이트': '디에틸아미노하이드록시벤조일헥실벤조에이트',
    '메틸프로판디이올': '메틸프로판다이올',
    '멘톨시프로판다이올': '멘톡시프로판다이올',
    '메칠살리실레이트': '메틸살리실레이트',

    # 사 계열
    '사이아노코발라민': '사이아노코발아민',
    '사이클로펜E실록세인': '사이클로펜타실록세인',
    '사이클로펜타실록산': '사이클로펜타실록세인',
    '사이클로헥사실록산': '사이클로헥사실록세인',
    '살리실릭애씨드': '살리실릭애시드',
    '삼성왁스': '합성왁스',
    '삼식제비꽃추출물': '삼색제비꽃추출물',
    '석시닉애씨드': '석시닉애시드',
    '세라이드': '세라마이드',
    '세터아릴올리베이트': '세테아릴올리베이트',
    '소듐도데시놀-40설페이트': '소듐라우레스-40설페이트',
    '소듐도데실놀-40설페이트': '소듐라우레스-40설페이트',
    '소듐라우레스-12살페이트': '소듐라우레스-12설페이트',
    '소듐메틸스테아로일타유레이트': '소듐메틸스테아로일타우레이트',
    '소듐스타치옥테닐': '소듐스타치옥테닐석시네이트',
    '소듐아세틸레이티드시하이알루로네이트': '소듐아세틸레이티드하이알루로네이트',
    '소듐아세틸레이티드이알루로네이트': '소듐아세틸레이티드하이알루로네이트',
    '소듐아세틸레이티드하이알루로너이트': '소듐아세틸레이티드하이알루로네이트',
    '소듐아스코빌포스페': '소듐아스코빌포스페이트',
    '소듐아크릴레이트코폴리미': '소듐아크릴레이트코폴리머',
    '소듐하이알루': '소듐하이알루로네이트',
    '소듐하이알루로너이트': '소듐하이알루로네이트',
    '소듐히이알루로네이트': '소듐하이알루로네이트',
    '소르빅애씨드': '소르빅애시드',
    '스터아릭애씨드': '스테아릭애시드',
    '스테아르애씨드': '스테아릭애시드',
    '스테이릭애씨드': '스테아릭애시드',
    '스테아릴알로올': '스테아릴알코올',
    '스테아릴일코올': '스테아릴알코올',
    '시이클로펜타실록세인': '사이클로펜타실록세인',
    '시트릭애씨드': '시트릭애시드',
    '실리실릭애씨드': '살리실릭애시드',
    '실리키실릴레이트': '실리카실릴레이트',
    '실메톡시신나메이트': '에틸헥실메톡시신나메이트',
    '신선초추출물추출물': '신선초추출물',
    '씨솔트': '소듐클로라이드',

    # 아 계열
    '아리키딜알코올': '아라키딜알코올',
    '아라키딕애씨드': '아라키딕애시드',
    '아미노부티릭애씨드': '아미노부티릭애시드',
    '아스코빅애씨드': '아스코빅애시드',
    '아스파틱애씨드': '아스파틱애시드',
    '아시아투애씨드': '아시아틱애시드',
    '아이소스테아릭애씨드': '아이소스테아릭애시드',
    '아이소스테아릴네오펀타노에이트': '아이소스테아릴네오펜타노에이트',
    '아이소트라이데실아이소노노노에이트': '아이소트라이데실아이소노나노에이트',
    '아이소데실네오펜타노어이트': '아이소데실네오펜타노에이트',
    '아이소프로필티타늄트라이O이소스테아레이트': '아이소프로필티타늄트라이아이소스테아레이트',
    '아이소프로필티타늄트라이아0소스테아레이트': '아이소프로필티타늄트라이아이소스테아레이트',
    '아이소프로필티타늄트라이아이쇼스테아레이트': '아이소프로필티타늄트라이아이소스테아레이트',
    '아이소프로필티타늄트라이이이소스테아레이트': '아이소프로필티타늄트라이아이소스테아레이트',
    '아크릴레이트(스테아레스-20메타크릴레이트코폴리머': '아크릴레이트/스테아레스-20메타크릴레이트코폴리머',
    '아크릴레이트/CO-30알칼아크릴레이트크로스폴리머': '아크릴레이트/C10-30알킬아크릴레이트크로스폴리머',
    '아크릴레이트/소아크릴로일다이머틸타우레이트코폴리머': '아크릴레이트/소듐아크릴로일다이메틸타우레이트코폴리머',
    '아크릴레이트/스테아릴아크릴레o트/다이메티콘메타크릴레이트코폴리머': '아크릴레이트/스테아릴아크릴레이트/다이메티콘메타크릴레이트코폴리머',
    '아크릴레이트/스테아릴아크릴레이트/다이메티콘머타크릴레이트코폴리머': '아크릴레이트/스테아릴아크릴레이트/다이메티콘메타크릴레이트코폴리머',
    '아크릴레이트/베헤네스-25메타크림레이트코폴리머': '아크릴레이트/베헤네스-25메타크릴레이트코폴리머',
    '아크릴로일디메틸타우레이트코폴리머': '소듐아크릴로일다이메틸타우레이트코폴리머',
    '암도눔폴리아크릴레이트': '암모늄폴리아크릴레이트',
    '암모늄0크크로일다이메틸타우러이트/브이피코폴리머': '암모늄아크릴로일다이메틸타우레이트/브이피코폴리머',
    '암모늄아크릴레o트코폴리머': '암모늄아크릴레이트코폴리머',
    '암모늄아크릴로일다이머l틸타우레이트/브이피코폴리머': '암모늄아크릴로일다이메틸타우레이트/브이피코폴리머',
    '암모늄아크릴로일다이메틸E우레이트/브이피코폴리머': '암모늄아크릴로일다이메틸타우레이트/브이피코폴리머',
    '암모늄아크릴로일다이메틸우레이트': '암모늄아크릴로일다이메틸타우레이트',
    '암모늄아크릴로일다이메틸타우레o트/브이피코폴리머': '암모늄아크릴로일다이메틸타우레이트/브이피코폴리머',
    '암모늄아크릴로일다이메틸타우레이.트/브이피코폴리머': '암모늄아크릴로일다이메틸타우레이트/브이피코폴리머',
    '암모늄이크릴로일다이메틸타우레이트/브이피코폴리머': '암모늄아크릴로일다이메틸타우레이트/브이피코폴리머',
    '암모늄폴리아크릴로일다O메틸타우레이트': '암모늄폴리아크릴로일다이메틸타우레이트',
    '암모늄폴리아크릴로일다이메틸타워레이트': '암모늄폴리아크릴로일다이메틸타우레이트',
    '이알루로닉애씨드': '하이알루로닉애시드',

    # 에틸헥실 계열
    '에칠헥실메톡시신나메트': '에틸헥실메톡시신나메이트',
    '에칠헥실메톡시신나메이트': '에틸헥실메톡시신나메이트',
    '에칠헥실트리아존': '에틸헥실트리아존',
    '에칠헥실살리실레이트': '에틸헥실살리실레이트',
    '에틸헥실디메틸파바': '에틸헥실다이메틸파바',
    '에틸헥실메톡시신메이트': '에틸헥실메톡시신나메이트',
    '옥딜도데칸올': '옥틸도데칸올',
    '오카무리큰실말추출물': '오카무라큰실말추출물',
    '에테르헥실글리세린': '에틸헥실글리세린',

    # 자 계열
    '자일라우릴글루코사이드': '라우릴글루코사이드',
    '제라니니올': '제라니올',
    '접스꽃추출물': '접시꽃추출물',
    '전판홍경천뿌리추출물': '홍경천뿌리추출물',
    '쟈스민꽃추출물': '자스민꽃추출물',
    '쟈스민추출물': '자스민추출물',
    '즈오브예리코추출물': '예리코부활초추출물',

    # 차/카 계열
    '청순냥다이메티콘': '다이메티콘',
    '친절냥다이메티콘': '다이메티콘',
    '칠헥실메톡시신나메이트': '에틸헥실메톡시신나메이트',
    '치스트로베리추출물': '스트로베리추출물',
    '카카오씨드버터': '카카오씨버터',
    '카바카바일/뿌리/즐기추출물': '카바카바잎/뿌리/줄기추출물',
    '카프릴로일살리실': '카프릴로일살리실릭애시드',
    '카프릴로일살리실릭애씨I드': '카프릴로일살리실릭애시드',
    '카프릴로일살리실릭이씨드': '카프릴로일살리실릭애시드',
    '카프릴릭/카릭트라이글리세라이드': '카프릴릭/카프릭트라이글리세라이드',
    '카프릴릭/키프릭트라이글리세라이드': '카프릴릭/카프릭트라이글리세라이드',
    '카프릴릭/카프릭글리세라이즈': '카프릴릭/카프릭글리세라이드',
    '카프릴릭/카프릭글리세리이즈': '카프릴릭/카프릭글리세라이드',
    '카프릴릭/카프릭트2이글리세라이드': '카프릴릭/카프릭트라이글리세라이드',
    '카프릴릭/카프릭트라0글리세라이드': '카프릴릭/카프릭트라이글리세라이드',
    '카프릴릭/카프릭트라0글리세라이트': '카프릴릭/카프릭트라이글리세라이드',
    '카프릴릭/카프릭트라이글러세라이드': '카프릴릭/카프릭트라이글리세라이드',
    '카프릴릭/카프릭트라이글리서라이드': '카프릴릭/카프릭트라이글리세라이드',
    '카프릴릭/카프릭트라이글리세2이드': '카프릴릭/카프릭트라이글리세라이드',
    '카프릴릭/카프릭트라이글리세라o드': '카프릴릭/카프릭트라이글리세라이드',
    '카프릴릭/카프릭트리글리세라이드': '카프릴릭/카프릭트라이글리세라이드',
    '카프릴릭/카프릭트리이글리세라이드': '카프릴릭/카프릭트라이글리세라이드',
    '카프릴하이드록사애씨드': '카프릴하이드록사믹애시드',
    '칼슘티타늄산화물': '칼슘티타늄옥사이드',
    '캠아줄렌': '카마줄렌',
    '코카미도프피베타인': '코카미도프로필베타인',
    '코카미도프로필피지-디모늄클로리이드포스페이트': '코카미도프로필피지-디모늄클로라이드포스페이트',
    '코코넛야지오일': '코코넛야자오일',
    '콜리글리세릴4등리아이트': '폴리글리세릴-4올리에이트',
    '콜리메틸에타크릴레이트': '폴리메틸메타크릴레이트',
    '콜미틸테트라펩타이드-7': '팔미토일테트라펩타이드-7',
    '크릴레이트크로스폴리머': '아크릴레이트크로스폴리머',
    '클레리오일': '클라리세이지오일',
    '클레리추출물': '클라리세이지추출물',
    '쿨모브트라이메틸실록시실리케이트': '트라이메틸실록시실리케이트',
    '쿨스텝에틸헥실팔미테이트': '에틸헥실팔미테이트',
    '케어루틴': '루틴',

    # 타/트 계열
    '택틱애씨드': '락틱애시드',
    '테레프탈릴리덴디캠퍼설포닉애시드': '테레프탈릴리덴디캠퍼설포닉애씨드',
    '토코페닐아세테이트': '토코페릴아세테이트',
    '토코페릴아서테이트': '토코페릴아세테이트',
    '토코페릴아세터이트': '토코페릴아세테이트',
    '트라이소듐에틸렌다이아민다O석시네이트': '트라이소듐에틸렌다이아민다이석시네이트',
    '트라이에톡시카프릴림실레인': '트라이에톡시카프릴릴실레인',
    '트라이에틸트레이트': '트라이에틸시트레이트',
    '트루로즈오브예리코추출물': '예리코부활초추출물',
    '트리에톡시카프릴릴실란': '트라이에톡시카프릴릴실레인',
    '트리이데세스-6': '트라이데세스-6',
    '트릭애씨드': '시트릭애씨드',
    '티드레시틴': '레시틴',
    '티타늄/티타늄다이옥사이드': '티타늄디옥사이드',
    '티타늄디아이스블루옥사이드': '티타늄디옥사이드',

    # 파/피 계열
    '파피인': '파파인',
    '팬틸렌글라이콜': '펜틸렌글라이콜',
    '페녹시어탄올': '페녹시에탄올',
    '페녹에탄올': '페녹시에탄올',
    '팔미틱애시드': '팔미틱애씨드',
    '포타슘솔베이트': '포타슘소르베이트',
    '포타슘흐이알루로네이트': '포타슘하이알루로네이트',
    '폴리C10-30알킬아크릴러1이트': '폴리C10-30알킬아크릴레이트',
    '폴리글리서l릴-4카프레이트': '폴리글리세릴-4카프레이트',
    '폴리솔베이트20': '폴리소르베이트20',
    '폴리솔베이트60': '폴리소르베이트60',
    '폴리솔베이트80': '폴리소르베이트80',
    '폴리아크릴레이토크로스플리머-6': '폴리아크릴레이트크로스폴리머-6',
    '폴리아크릴레이트로스폴리머-6': '폴리아크릴레이트크로스폴리머-6',
    '프로필털카프릴레이트': '프로필카프릴레이트',
    '프로필틸카프틸레이트': '프로필카프릴레이트',
    '피브이엠/엠에이코폴리머': 'PVM/MA코폴리머',
    '피피자-17': '피피지-17',
    '피피치10/1다이메티콘': '피피지-10/1다이메티콘',

    # 하 계열
    '하는하이알루로닉애씨드': '하이알루로닉애씨드',
    '하이드돌라이즈드하이알루로닉애씨드': '하이드롤라이즈드하이알루로닉애씨드',
    '하이드롤라이즈드하0알루로닉애씨드': '하이드롤라이즈드하이알루로닉애씨드',
    '하이알루로닉애시드': '하이알루로닉애씨드',
    '하이알하는루로닉애씨드': '하이알루로닉애씨드',
    '히이알루로닉애씨드': '하이알루로닉애씨드',
    '하이드로롯데네이티드레시틴': '하이드로제네이티드레시틴',
    '하이드로제네이티드레세라마이드엔피': '하이드로제네이티드세라마이드엔피',
    '하이드로제네이티드레시': '하이드로제네이티드레시틴',
    '하이드로제네이티드스타이렌/이이소프렌코폴리머': '하이드로제네이티드스타이렌/아이소프렌코폴리머',
    '하이드로제네이티드스티치하이드롤리세이트': '하이드로제네이티드스타치하이드롤리세이트',
    '하이드로제네이티드시틴': '하이드로제네이티드레시틴',
    '하이드로제네이티드코코-글2세라이즈': '하이드로제네이티드코코-글리세라이드',
    '하이드로제네이티드폴리O이소부텐': '하이드로제네이티드폴리아이소부텐',
    '하이드로제네이티드폴리더센': '하이드로제네이티드폴리데센',
    '하이드로제네이티드폴리아이소부덴': '하이드로제네이티드폴리아이소부텐',
    '하이드로제네이티드폴리이이소부텐': '하이드로제네이티드폴리아이소부텐',
    '하이드로제네이티드플리아이소부텐': '하이드로제네이티드폴리아이소부텐',
    '하이드로제네이티드필리아이소부텐': '하이드로제네이티드폴리아이소부텐',
    '하이드로젠다이메티콘': '하이드로제네이티드다이메티콘',
    '하이드록시에틸0크크레이트': '하이드록시에틸아크릴레이트',
    '하이드록시에틸아릴레이트': '하이드록시에틸아크릴레이트',
    '하는시트릭애씨드': '시트릭애씨드',
    '하이드록시시트로넬알': '하이드록시시트로넬랄',
    '하이드록시아틸아크릴레이트': '하이드록시에틸아크릴레이트',
    '하이드록프로필트라이모늄하이알루로네이트': '하이드록시프로필트라이모늄하이알루로네이트',
    '하이드롤라이즈드소듐하알루로네이트': '하이드롤라이즈드소듐하이알루로네이트',
    '하이드플라이즈드하이알루로닉애씨드': '하이드롤라이즈드하이알루로닉애씨드',
    '합성플루오르플로그라이트': '합성플루오르플로고파이트',
    '헥사펩타이드-9(100ppb': '헥사펩타이드-9',
    '베르가못잎추출물': '베르가모트잎추출물',
    '바세린': '페트롤라툼',
    '비에이치티': 'BHT',
    '비타민C': '아스코빅애시드',
    '복류산산세베리아잎추출물': '산세베리아잎추출물',
    '복륜산산세베리아잎추출물': '산세베리아잎추출물',
    '복륜산산세비에리아잎추출물': '산세베리아잎추출물',
    '부틸렌글라이콜본상품정보(상품상세': '부틸렌글라이콜',
    '부틸렌글라이콜다이카프릴러이트': '부틸렌글라이콜다이카프릴레이트',
    '분홍바늘꽃꽃/잎/즐기추출물': '분홍바늘꽃꽃/잎/줄기추출물',
    '비닐다이메E콘/메티콘실세스퀴옥서인크로스폴리머': '비닐다이메티콘/메티콘실세스퀴옥세인크로스폴리머',
    '비닐다이에티콘/메티콘실세스퀴옥세인크로스폴리머': '비닐다이메티콘/메티콘실세스퀴옥세인크로스폴리머',

    # 디에틸아미노 계열
    '디에칠실부타미도트리아촌': '디에틸헥실부타미도트리아존',
    '디에칠아미노하이드록시벤조일실벤조에이트': '디에틸아미노하이드록시벤조일헥실벤조에이트',
    '디에틸아미노하이드록벤조일헥실벤조에이트': '디에틸아미노하이드록시벤조일헥실벤조에이트',
    '디에틸아미노하이드록시번조일헥실벤조에이트': '디에틸아미노하이드록시벤조일헥실벤조에이트',
    '디에틸아미노하이드록시벤조일혁실벤조에이트': '디에틸아미노하이드록시벤조일헥실벤조에이트',
}

# 수정 적용
correction_count = 0
for old, new in corrections.items():
    mask = df['ingredient'] == old
    if mask.sum() > 0:
        correction_count += mask.sum()
        df.loc[mask, 'ingredient'] = new

print(f"수정 적용: {correction_count}개 성분 수정됨")

# =====================================================
# 3) 분리 규칙 적용 (복합 문자열 분리)
# =====================================================
split_rules = {
    '글리세릴카프릴레이트에틸헥실글리세린': ['글리세릴카프릴레이트', '에틸헥실글리세린'],
    '글리세릴스테아레이트라우릴하이드록시설테인': ['글리세릴스테아레이트', '라우릴하이드록시설테인'],
    '금불초꽃/잎/줄기추출물': ['금불초꽃추출물', '금불초잎추출물', '금불초줄기추출물'],
    '다이메티콘/비닐다이메티콘크료스폴리머트라이소듐에틸렌다이아민다이석시네이트': ['다이메티콘/비닐다이메티콘크로스폴리머', '트라이소듐에틸렌다이아민다이석시네이트'],
    '다이소듐이디티에이부틸렌글라이콜': ['다이소듐이디티에이', '부틸렌글라이콜'],
    '다이부틸아디페이트프로판다이올': ['다이부틸아디페이트', '프로판다이올'],
    '디메치콘이소프로필팔미터이트': ['다이메티콘', '아이소프로필팔미테이트'],
    '당아욱꽃/잎/줄기추출물': ['당아욱꽃추출물', '당아욱잎추출물', '당아욱줄기추출물'],
    '마데카식애씨드아시아틱애씨드': ['마데카식애시드', '아시아틱애시드'],
    '마그네슘스테아레이다이메닐실록시페닐트라이메티콘': ['마그네슘스테아레이트', '다이페닐실록시페닐트라이메티콘'],
    '마카다미아씨오일폴리글리세릴6에스터스베헤네이트': ['마카다미아씨오일', '폴리글리세릴-6에스터스'],
    '무릎냥브라운다이아이소스테아릴말레이트': ['다이아이소스테아릴말레이트'],
    '뮤트메모리다이메티콘': ['다이메티콘'],
    '뮤트브라운아이소도데케인': ['아이소도데케인'],
    '뮤트핑크다이아이소스테아릴말레이트': ['다이아이소스테아릴말레이트'],
    '미이지-60하이드로제네이티드캐스터오일': ['PEG-60하이드로제네이티드캐스터오일'],
    '베이지다이아이소스테아릴말레1이트': ['다이아이소스테아릴말레이트'],
    '베일라이트에틸헥실팔미테이트': ['에틸헥실팔미테이트'],
    '부틸렌글펜틸렌글라이콜': ['부틸렌글라이콜', '펜틸렌글라이콜'],
    '소듐클시트릭애씨드다이소듐이디티에이': ['소듐시트레이트', '다이소듐이디티에이'],
    '소듐디엔에이(1': ['소듐디엔에이'],
    '소듐아세틸레이티드하이알루로네이트유무': ['소듐아세틸레이티드하이알루로네이트'],
    '소듐하이알루로네이트(50': ['소듐하이알루로네이트'],
    '소듐하이알루로네이트다이메틸실란올': ['소듐하이알루로네이트', '다이메틸실란올하이알루로네이트'],
    '소듐하이알루로네이트크로스폴리머포타슘하이알루로네이트': ['소듐하이알루로네이트크로스폴리머', '포타슘하이알루로네이트'],
    '솔비탄올리베이트스테아릭애씨드': ['솔비탄올리베이트', '스테아릭애시드'],
    '실리카다이메틸실릴레이트다이아이소스테아릴말레이트': ['실리카다이메틸실릴레이트', '다이아이소스테아릴말레이트'],
    '세틸피리다눔클로라이드카프릴릴글라이콜': ['세틸피리디늄클로라이드', '카프릴릴글라이콜'],
    '알루미늄하이드록사이드스타아니스추출물': ['알루미늄하이드록사이드', '스타아니스추출물'],
    '알루미늄하이드록사이드페녹시에탄올': ['알루미늄하이드록사이드', '페녹시에탄올'],
    '알파-아이소메틸아이오논제라니올': ['알파-아이소메틸아이오논', '제라니올'],
    '에틸아스코빌에텔(3-0-에틸아스코빅애씨드)': ['3-O-에틸아스코빅애시드'],
    '에틸헥실글리세린다이소듐이디': ['에틸헥실글리세린', '다이소듐이디티에이'],
    '에틸헥실글리세린소듐파이테이트': ['에틸헥실글리세린', '소듐파이테이트'],
    '에틸헥실글리세린헥실렌글라이콜': ['에틸헥실글리세린', '헥실렌글라이콜'],
    '에틸헥실글리세린식품의약안전처미백': ['에틸헥실글리세린'],
    '에틸헥실글리세린약산성젤클렌저': ['에틸헥실글리세린'],
    '에틸헥실글리세린틴옥사이드': ['에틸헥실글리세린', '틴옥사이드'],
    '에틸헥실메톡시신나': ['에틸헥실메톡시신나메이트'],
    '아이스베리셔벗옥틸도데칸올': ['옥틸도데칸올'],
    '아이소프로필미리스터이트카프릴릭/카프릭트라이글리세라이드': ['아이소프로필미리스테이트', '카프릴릭/카프릭트라이글리세라이드'],
    '적색104폴리리시놀리에이트': ['적색104호', '폴리리시놀리에이트'],
    '적색202호티타늄디옥사이드': ['적색202호', '티타늄디옥사이드'],
    '카프릴로일살리실릭애씨드살리실릭애씨드': ['카프릴로일살리실릭애시드', '살리실릭애시드'],
    '카프릴하이드록사믹애씨드-:정제수': ['카프릴하이드록사믹애시드', '정제수'],
    '카프릴하이드록사믹애씨드정제수': ['카프릴하이드록사믹애시드', '정제수'],
    '카프릴릴메티콘솔비탄올리베이트': ['카프릴릴메티콘', '솔비탄올리베이트'],
    '카프릴릴메티콘풍선덩굴꽃/잎': ['카프릴릴메티콘', '풍선덩굴꽃/잎추출물'],
    '코코넛애프리콧다이아이소스테아릴말레이트': ['다이아이소스테아릴말레이트'],
    '코카도프로필피자다이모늄클로라이드포페이트시트릭애씨드': ['코카미도프로필피지-디모늄클로라이드포스페이트', '시트릭애씨드'],
    '캐스터오일/아이피디아이코폴리머': ['캐스터오일', '아이피디아이코폴리머'],
    '카프릴릴/카프릴글루코사이드': ['카프릴릴글루코사이드'],
    '탤크다이메티콘': ['탤크', '다이메티콘'],
    '탤크칼슘알루미늄보로실리케이트': ['탤크', '칼슘알루미늄보로실리케이트'],
    '토코페릴아세테이트비즈왁스': ['토코페릴아세테이트', '비즈왁스'],
    '토코페릴아세테이트코카미도프로필베타인낫토검': ['토코페릴아세테이트', '코카미도프로필베타인', '낫토검'],
    '트라이메틸실록시실리케이트/다이메티콘올크로스폴리머': ['트라이메틸실록시실리케이트', '다이메티콘올크로스폴리머'],
    '트라이메틸펜타페닐트라이실록세인C14-22알코올': ['트라이메틸펜타페닐트라이실록세인', 'C14-22알코올'],
    '티타늄디옥사이드헥실라우레이트': ['티타늄디옥사이드', '헥실라우레이트'],
    '팔미토일테트라펩타이드-7석류추출물': ['팔미토일테트라펩타이드-7', '석류추출물'],
    '폴리소르베이트20레티놀카프릴릭/카프릭트라이글리세라이드': ['폴리소르베이트20', '레티놀', '카프릴릭/카프릭트라이글리세라이드'],
    '피마자씨오일호호바씨오일': ['피마자씨오일', '호호바씨오일'],
    '피부의미백에도움을이크로크리스탈린왁스': ['마이크로크리스탈린왁스'],
    '포타슘하이알루로네이트별': ['포타슘하이알루로네이트'],
    '폴리글리세릴-3청색1호': ['폴리글리세릴-3', '청색1호'],
    '폴리글리세릴-3다이스테아레이트정제수': ['폴리글리세릴-3다이스테아레이트', '정제수'],
    '폴리글리세릴-10미리스테이트펜틸렌글라이콜': ['폴리글리세릴-10미리스테이트', '펜틸렌글라이콜'],
    '프로필렌카보네이에틸헥실글리세린향료': ['프로필렌카보네이트', '에틸헥실글리세린', '향료'],
    '크림하이라이터펜타에리스리틸아디페이트카프레이트/카프릴레이트/헵타노에이트': ['펜타에리스리틸아디페이트/카프레이트/카프릴레이트/헵타노에이트'],
    '하이드록시아세토페논해바라기씨오일': ['하이드록시아세토페논', '해바라기씨오일'],
    '하이드로제네이티드팜애씨드글리세린': ['하이드로제네이티드팜애씨드', '글리세린'],
    '하이드로제네이티드캐스터하이드로제네이티드코코-글리세라이즈': ['하이드로제네이티드캐스터오일', '하이드로제네이티드코코-글리세라이드'],
    '하이드롤라이즈드하이알루로닉애씨드하이알루로닉애씨드': ['하이드롤라이즈드하이알루로닉애씨드', '하이알루로닉애씨드'],
    '합성플루오르플로고파이트칼슘알루미늄보로실리케이트': ['합성플루오르플로고파이트', '칼슘알루미늄보로실리케이트'],
    '헥실렌글라이콜포타슘라우레이트': ['헥실렌글라이콜', '포타슘라우레이트'],
    '헥산다이에틸헥실글리세린': ['헥산다이올', '에틸헥실글리세린'],
    '황색4호스타아니스추출물': ['황색4호', '스타아니스추출물'],
    '흑색산화철다이아이소스테아릴말레이트': ['흑색산화철', '다이아이소스테아릴말레이트'],
    '흑색산화철아이소프로필미리스테이트': ['흑색산화철', '아이소프로필미리스테이트'],
}

# 분리 적용
new_rows = []
rows_to_drop = []

for idx, row in df.iterrows():
    ingredient = row['ingredient']
    if ingredient in split_rules:
        rows_to_drop.append(idx)
        for new_ingredient in split_rules[ingredient]:
            new_row = row.copy()
            new_row['ingredient'] = new_ingredient
            new_rows.append(new_row)

df = df.drop(rows_to_drop)
if new_rows:
    new_df = pd.DataFrame(new_rows)
    df = pd.concat([df, new_df], ignore_index=True)
    print(f"분리 적용: {len(rows_to_drop)}개 행 → {len(new_rows)}개 행으로 분리됨")

# =====================================================
# 4) 애씨드 → 애시드 통일 (추가)
# =====================================================
# 애씨드 → 애시드로 통일
acid_corrections = [
    ('글라이콜릭애씨드', '글라이콜릭애시드'),
    ('글루코닉애씨드', '글루코닉애시드'),
    ('글루쿠로닉애씨드', '글루쿠로닉애시드'),
    ('글루타믹애씨드', '글루타믹애시드'),
    ('글리시레티닉애씨드', '글리시레티닉애시드'),
    ('라우릭애씨드', '라우릭애시드'),
    ('락틱애씨드', '락틱애시드'),
    ('락토바이오닉애씨드', '락토바이오닉애시드'),
    ('리놀레닉애씨드', '리놀레닉애시드'),
    ('리놀레익애씨드', '리놀레익애시드'),
    ('만델릭애씨드', '만델릭애시드'),
    ('말릭애씨드', '말릭애시드'),
    ('미리스틱애씨드', '미리스틱애시드'),
    ('베헤닉애씨드', '베헤닉애시드'),
    ('벤조익애씨드', '벤조익애시드'),
    ('살리실릭애씨드', '살리실릭애시드'),
    ('석시닉애씨드', '석시닉애시드'),
    ('소르빅애씨드', '소르빅애시드'),
    ('스테아릭애씨드', '스테아릭애시드'),
    ('시트릭애씨드', '시트릭애시드'),
    ('아라키딕애씨드', '아라키딕애시드'),
    ('아미노부티릭애씨드', '아미노부티릭애시드'),
    ('아스코빅애씨드', '아스코빅애시드'),
    ('아스파틱애씨드', '아스파틱애시드'),
    ('아시아틱애씨드', '아시아틱애시드'),
    ('아이소스테아릭애씨드', '아이소스테아릭애시드'),
    ('올레아놀릭애씨드', '올레아놀릭애시드'),
    ('올레익애씨드', '올레익애시드'),
    ('카프로익애씨드', '카프로익애시드'),
    ('카프릭애씨드', '카프릭애시드'),
    ('카프릴하이드록사믹애씨드', '카프릴하이드록사믹애시드'),
    ('캠퍼설포닉애씨드', '캠퍼설포닉애시드'),
    ('코코넛애씨드', '코코넛애시드'),
    ('클로로제닉애씨드', '클로로제닉애시드'),
    ('타타릭애씨드', '타타릭애시드'),
    ('탄닉애씨드', '탄닉애시드'),
    ('택틱애씨드', '락틱애시드'),
    ('트라넥사믹애씨드', '트라넥사믹애시드'),
    ('티옥틱애씨드', '티옥틱애시드'),
    ('팔미틱애씨드', '팔미틱애시드'),
    ('페룰릭애씨드', '페룰릭애시드'),
    ('폴릭애씨드', '폴릭애시드'),
    ('하이알루로닉애씨드', '하이알루로닉애시드'),
    ('마데카식애씨드', '마데카식애시드'),
    ('파이루빅애씨드', '파이루빅애시드'),
    ('판토테닉애씨드', '판토테닉애시드'),
    ('페닐벤즈이미다졸설포닉애씨드', '페닐벤즈이미다졸설포닉애시드'),
    ('폴리글루타믹애씨드', '폴리글루타믹애시드'),
    ('폴리하이드록시스테아릭애씨드', '폴리하이드록시스테아릭애시드'),
    ('카프릴로일글리세린/세바식애씨드코폴리머', '카프릴로일글리세린/세바식애시드코폴리머'),
    ('카프릴로일살리실릭애씨드', '카프릴로일살리실릭애시드'),
    ('트라이메틸펜탄다이올/아디픽애씨드', '트라이메틸펜탄다이올/아디픽애시드코폴리머'),
]

for old, new in acid_corrections:
    df.loc[df['ingredient'] == old, 'ingredient'] = new

# =====================================================
# 5) 최종 정리
# =====================================================
df['ingredient'] = df['ingredient'].str.strip()
df = df[df['ingredient'] != ''].copy()

before_dedup = len(df)
df = df.drop_duplicates(subset=['product_id', 'ingredient'], keep='first')
after_dedup = len(df)
print(f"중복 제거: {before_dedup - after_dedup}개")

df = df.sort_values(['product_id', 'ingredient']).reset_index(drop=True)
df.to_csv('/Users/yu_seok/Documents/workspace/nbCamp/Project/Why-pi/data/csv/ingredients_통합.csv', index=False, encoding='utf-8-sig')

unique_ingredients = df['ingredient'].unique()
unique_df = pd.DataFrame({'ingredient': sorted(unique_ingredients)})
unique_df.to_csv('/Users/yu_seok/Documents/workspace/nbCamp/Project/Why-pi/data/csv/ingredients_unique_merged.csv', index=False)

print(f"\n=== 최종 결과 ===")
print(f"총 행: {len(df)}")
print(f"총 제품: {df['product_id'].nunique()}")
print(f"고유 성분: {len(unique_ingredients)}")

# 영문 성분 확인
english_pattern = r'^[A-Za-z]'
english_ingredients = unique_df[unique_df['ingredient'].str.match(english_pattern, na=False)]
if len(english_ingredients) > 0:
    print(f"\n영문 성분 ({len(english_ingredients)}개):")
    for ing in english_ingredients['ingredient'].values[:20]:
        print(f"  - {ing}")

# 애씨드/애시드 확인
acid_씨_count = df['ingredient'].str.contains('애씨드', na=False).sum()
acid_시_count = df['ingredient'].str.contains('애시드', na=False).sum()
print(f"\n애씨드: {acid_씨_count}개, 애시드: {acid_시_count}개")
